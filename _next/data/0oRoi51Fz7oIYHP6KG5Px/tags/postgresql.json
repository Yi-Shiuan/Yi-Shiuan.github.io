{"pageProps":{"posts":[{"id":1664841600,"fileName":"postgresql-insert-or-update","url":"2022/10/04/postgresql-insert-or-update","title":"Postgresql 的Merge語法","description":"在SQL Server中有一個語法是merge的語法，他可以根據特定的條件執行特定的操作，如資料存在就更新不存在就新增。 但在Postgresql中，似乎沒有merge的語法可以使用...但在程式理先去得資料在判斷是否更新或新增這樣的情境容易導致一些後遺症.... 在google後，其實有很多方式但...嘗試後只有這個方法是可行的，所以在這邊筆記一下","date":"2022-10-04T00:00:00.000Z","tags":["postgresql","database"],"published":true,"content":"\n在SQL Server中有一個語法是`merge`的語法，他可以根據特定的條件執行特定的操作，如資料存在就更新不存在就新增。\n但在Postgresql中，似乎沒有merge的語法可以使用...但在程式理先去得資料在判斷是否更新或新增這樣的情境容易導致一些後遺症....\n在google後，其實有很多方式但...嘗試後只有這個方法是可行的，所以在這邊筆記一下\n\n> postgresql的版本是13\n\n```plsql\nINSERT INTO public.table (user_id, name, email)\nVALUES (@userid, @username, @user_email)\nON CONFLICT (user_id)\n    DO UPDATE SET (name, email) = (@username, @user_email)\nWHERE members.user_id = @userid;\n```\n當table中user_id衝突時，就會自動執行update，這樣一來根SQL server中的merge語句就相同了！\n\n\n### 參考資料\n\n[postgresql insert](https://www.postgresql.org/docs/current/sql-insert.html)\n"}],"allTags":{"gatsbyjs":1,"nextjs":1,"postgresql":1,"database":2,"dotnet":1,"aws":4,"devops":7,"prevision":6,"iot":2,"platformio":2,"arduino":2,"esp":1,"elk":3,"azure":4,"vulnerability":1,"ssl":2,"vmss":1,"cd":3,"study4":1,"dotnetconf":1,"selenium":2,"tdd":1,"react":3,"jest":1,"next.js":1,"frontend":1,"layout":1,"ec2":1,"iac":1,"terraform":1,"ci":1,"jenkins":1,"ecs":1,"ansible":1,"redis":2,"protobuf":2,"serialize":2,"deserialize":2,"pub":1,"sub":1,"notify":1}},"__N_SSG":true}