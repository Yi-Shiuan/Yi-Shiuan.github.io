{"pageProps":{"id":1641168000,"fileName":"vulnerability-scanning-for-ssl-support-algorithm","url":"2022/01/03/vulnerability-scanning-for-ssl-support-algorithm","title":"弱點掃描-SSL加密演算法不安全的演算法","description":"最近公司資安檢查報告中被檢查出了一個關於SSL的加密連線的弱點，這個弱點是因為我們沒有把不安全的加密演算法關閉導致這個弱點的產生， 在公司的政策中線上的伺服器不能任意安裝任何程式，所以`IISCrypto`就只能放棄無法使用，所以我修改的部分是使用修改幾碼的方式進行， 由於我不太熟悉資安，修改後要如何驗證呢這些已知有問題的演算法是否已經正確的被關閉了呢？","date":"2022-01-03T00:00:00.000Z","tags":["vulnerability","ssl"],"published":true,"content":"\n最近公司資安檢查報告中被檢查出了一個關於SSL的加密連線的弱點，這個弱點是因為我們沒有把不安全的加密演算法關閉導致這個弱點的產生，\n在公司的政策中線上的伺服器不能任意安裝任何程式，所以`IISCrypto`就只能放棄無法使用，所以我修改的部分是使用修改幾碼的方式進行，\n由於我不太熟悉資安，修改後要如何驗證呢這些已知有問題的演算法是否已經正確的被關閉了呢？\n\n所以我又在網路上google找到幾個腳本，透過openssl與curl的搭配可以掃描我們的server支援了哪些SSL的加密方式，有從server site的檢查與client site的檢查。\n\n```sh\n# server side\nURL=\"https://yi-shiuan.github.io/\"\n\nciphers=$(openssl ciphers 'ALL:eNULL' | sed -e 's/:/ /g')\n\n for cipher in ${ciphers[@]}\n do\n echo -n Testing $cipher...\n result=$(echo -n | openssl s_client -cipher \"$cipher\" -connect $URL 2>&1)\n if [[ \"$result\" =~ \":error:\" ]] ; then\n   error=$(echo -n $result | cut -d':' -f6)\n   echo NO \\($error\\)\n else\n   if [[ \"$result\" =~ \"Cipher is ${cipher}\" || \"$result\" =~ \"Cipher    :\" ]] ; then\n     echo YES\n   else\n     echo UNKNOWN RESPONSE\n     echo $result\n   fi\n fi\n sleep 1\n done\n```\n\n```sh\n# client site的檢查\nURL=\"https://yi-shiuan.github.io/\"\n\nDELAY=1\nciphers=$(openssl ciphers 'ALL:eNULL' | sed -e 's/:/ /g')\n\nfor cipher in ${ciphers[@]}\ndo\n    printf -v pad %30s\n    printf \"Checking ${cipher:0:30} ... \"\n    curl -s -S -o /dev/null --no-progress-meter --tls-max 1.2 --ciphers $cipher $URL\n    if [ $? -eq 0 ]; then\n        echo OK\n    fi\ndone\n```\n\n### 參考資料\n\n[IISCrypto](https://www.nartac.com/Products/IISCrypto)\n\n[叡揚資訊](https://www.gss.com.tw/blog/set-https-connect-protocols-and-ciphers)\n\n[SSL Ciphers](https://curl.se/docs/ssl-ciphers.html)\n","allTags":{"vue":1,"nuxt":1,"vite":1,"devops":8,"study4":2,"dotnetconf":2,"aws":5,"frontend":2,"next.js":4,"react":5,"i18n":1,"gatsby.js":1,"postgresql":1,"database":2,"dotnet":1,"prevision":6,"iot":2,"platformio":2,"arduino":2,"esp":1,"elk":3,"azure":4,"vulnerability":1,"ssl":2,"vmss":1,"cd":3,"selenium":2,"tdd":1,"jest":1,"layout":1,"ec2":1,"iac":1,"terraform":1,"ci":1,"jenkins":1,"ecs":1,"ansible":1,"redis":2,"protobuf":2,"serialize":2,"deserialize":2,"pub":1,"sub":1,"notify":1}},"__N_SSG":true}